<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.0 on Fri Jan 16 23:50:58 2009 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ajs_zage.pro (Anthony Smith's IDL routines)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ajs_zage.pro (Anthony Smith's IDL routines)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;+</span>
<span class="comments">; Convert redshift to age of Universe, in years</span>
<span class="comments">;</span>
<span class="comments">; See ajs_comdis for keyword parameters</span>
<span class="comments">; :Params:</span>
<span class="comments">;    z, in, required</span>
<span class="comments">;       Redshift (or array of values)</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    h0, in, optional</span>
<span class="comments">;       Hubble constant (default 70)</span>
<span class="comments">; :History:</span>
<span class="comments">;    10 Oct 2008 Written, Anthony Smith</span>
<span class="comments">;-</span>
FUNCTION ajs_zage, z, omega_m=omega_m, omega_l=omega_l, h0=h0, _REF_EXTRA=e
  compile_opt idl2
  COMMON cosmology, o_m, o_l
  IF n_elements(omega_m) EQ 0 THEN $
     o_m = 0.3 $
  ELSE $
     o_m = omega_m
  IF n_elements(omega_l) EQ 0 THEN $
     o_l = 0.7 $
  ELSE $
     o_l = omega_l
  IF n_elements(h0) EQ 0 THEN $
     h0 = 70

  <span class="comments">;; Analytic form from Liddle (2003) p. 59</span>
  IF o_m + o_l EQ 1 THEN $
     age =  2. / 3 * 1 / sqrt(1 - o_m) $
            * alog((1 + sqrt(1 - o_m)) / sqrt(o_m)) $
            * 3.085678e19 / h0 / 60. / 60. / 24. / 365.25 $
  ELSE $
     age = ajs_lookback_time(1e4, omega_m=o_m, omega_l=o_l, h0=h0, $
                             _STRICT_EXTRA=e)

  return, age - ajs_lookback_time(z, omega_m=o_m, omega_l=o_l, h0=h0, $
                                  _STRICT_EXTRA=e)
END
</code>
    </div>
  </body>
</html>