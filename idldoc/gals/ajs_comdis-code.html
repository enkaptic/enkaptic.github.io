<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.0 on Fri Jan 16 23:50:51 2009 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ajs_comdis.pro (Anthony Smith's IDL routines)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ajs_comdis.pro (Anthony Smith's IDL routines)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;+</span>
<span class="comments">; Return comoving distance to z, in Mpc</span>
<span class="comments">;-</span>


<span class="comments">;+</span>
<span class="comments">; Integrand for comoving distance integral</span>
<span class="comments">;-</span>
FUNCTION ajs_comdis_er, z
  compile_opt idl2, hidden

  COMMON cosmology, omega_m, omega_l
  return, 1.0 / sqrt(omega_m * (1 + z) ^ 3 $
                     + (1 - omega_m - omega_l) * (1 + z) ^ 2 $
                     + omega_l)
END


<span class="comments">;+</span>
<span class="comments">; Integrand for lookback time integral</span>
<span class="comments">;-</span>
FUNCTION ajs_lookback_er, z
  compile_opt idl2, hidden

  return, ajs_comdis_er(z) / (1 + z)
END


<span class="comments">;+</span>
<span class="comments">; Return comoving distance to z, in Mpc</span>
<span class="comments">; :Params:</span>
<span class="comments">;    z, in, required</span>
<span class="comments">;       Redshift (or array of values)</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    omega_m : in, optional</span>
<span class="comments">;       Matter density (default 0.3)</span>
<span class="comments">;    omega_l : in, optional</span>
<span class="comments">;       Vacuum energy density (default 0.7)</span>
<span class="comments">;    h0 : in, optional</span>
<span class="comments">;       Hubble constant (default 100)</span>
<span class="comments">;    c : in, optional</span>
<span class="comments">;       Speed of light (default 299792.458 km/s)</span>
<span class="comments">;    slow : in, optional</span>
<span class="comments">;       Set /slow to force calculation for each value (defaults to</span>
<span class="comments">;       interpolation if input array has more then 10,000 elements)</span>
<span class="comments">;    lookback_time : in, optional</span>
<span class="comments">;       Set /lookback_time to return lookback time in seconds.  See</span>
<span class="comments">;       ajs_lookback_time and ajs_zage.</span>
<span class="comments">; :History:</span>
<span class="comments">;    13 Mar 2008 Written, Anthony Smith</span>
<span class="comments">;</span>
<span class="comments">;    10 Oct 2008 Added lookback_time, AJS</span>
<span class="comments">;</span>
<span class="comments">;    16 Jan 2009 Corrected bug, which was affecting large input arrays</span>
<span class="comments">;-</span>
FUNCTION ajs_comdis, z, omega_m=omega_m, omega_l=omega_l, h0=h0, c=c, $
                     slow=slow, lookback_time=lookback_time
  compile_opt idl2
  COMMON cosmology, o_m, o_l
  IF n_elements(omega_m) EQ 0 THEN $
     o_m = 0.3 $
  ELSE $
     o_m = omega_m
  IF n_elements(omega_l) EQ 0 THEN $
     o_l = 0.7 $
  ELSE $
     o_l = omega_l
  IF n_elements(h0) EQ 0 THEN $
     h0 = 100
  IF n_elements(c) EQ 0 THEN $ 
     c = 299792.458
  
  z = double(z)
  IF n_elements(z) GT 1e4 AND NOT keyword_set(slow) THEN BEGIN
      z_arr = ajs_linspace(min(z), max(z), 5001)
      d_arr = ajs_comdis(z_arr, omega_m=o_m, omega_l=o_l, h0=h0, c=c, $
                         lookback_time=lookback_time)
      d = interpol(d_arr, z_arr, z, /quadratic)
  ENDIF ELSE BEGIN
      IF keyword_set(lookback_time) THEN $
         d = qromb('ajs_lookback_er', 0, z, /double) / h0 * 3.085678e19 $
      ELSE $
         d = qromb('ajs_comdis_er', 0, z, /double) * c / h0
  ENDELSE
  return, d
END
</code>
    </div>
  </body>
</html>