<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.0 on Fri Jan 16 23:50:52 2009 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ajs_double_schechter.pro (Anthony Smith's IDL routines)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ajs_double_schechter.pro (Anthony Smith's IDL routines)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;+</span>
<span class="comments">; This function generates a double Schechter function (single value of</span>
<span class="comments">; M-star, but two values for alpha and phi-star) along an input array of</span>
<span class="comments">; absolute magnitudes.</span>
<span class="comments">;</span>
<span class="comments">; Compatible with mpfit</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;    absmag : in, required</span>
<span class="comments">;       Array of absolute magnitudes</span>
<span class="comments">;    params : in, optional</span>
<span class="comments">;       [mstar, alpha_1, phistar_1, alpha_2, phistar_2] OR input separately:</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    mstar : in, optional</span>
<span class="comments">;    alpha_1 : in, optional</span>
<span class="comments">;    phistar_1 : in, optional</span>
<span class="comments">;    alpha_2 : in, optional</span>
<span class="comments">;    phistar_2 : in, optional</span>
<span class="comments">;    loglum : in, optional</span>
<span class="comments">;       Set to /loglum to input log10 luminosity instead of absolute magnitudes</span>
<span class="comments">; :Returns:</span>
<span class="comments">;    Array of phi for corresponding absmag</span>
<span class="comments">; :History:</span>
<span class="comments">;    21 April 2008 Written, Anthony Smith</span>
<span class="comments">;-</span>
FUNCTION ajs_double_schechter, $
   absmag, params, mstar=mstar, alpha_1=alpha_1, $
   phistar_1=phistar_1, alpha_2=alpha_2, $
   phistar_2=phistar_2, loglum=loglum
  compile_opt idl2

  IF n_params() EQ 2 THEN BEGIN
      mstar = params[0]
      alpha_1 = params[1]
      phistar_1 = params[2]
      alpha_2 = params[3]
      phistar_2 = params[4]
  ENDIF 

  absmag = double(absmag)
  IF keyword_set(loglum) THEN BEGIN
      phi = alog(10) $
            * (phistar_1 * 10 ^ (- (alpha_1 + 1) * (mstar - absmag)) $
               + phistar_2 * 10 ^ (- (alpha_2 + 1) * (mstar - absmag))) $
            * exp(-10 ^ (- (mstar - absmag)))
  ENDIF ELSE BEGIN
      phi = 0.4 * alog(10) $
            * (phistar_1 * 10 ^ (0.4 * (alpha_1 + 1) * (mstar - absmag)) $
               + phistar_2 * 10 ^ (0.4 * (alpha_2 + 1) * (mstar - absmag))) $
            * exp(-10 ^ (0.4 * (mstar - absmag)))
  ENDELSE

  RETURN, phi
END
</code>
    </div>
  </body>
</html>