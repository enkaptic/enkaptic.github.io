<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.0 on Fri Jan 16 23:50:59 2009 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ajs_gaussnd.pro (Anthony Smith's IDL routines)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ajs_gaussnd.pro (Anthony Smith's IDL routines)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;+</span>
<span class="comments">; This function returns the probability density at a given point</span>
<span class="comments">; _x_ for a multivariate normal distribution with specified</span>
<span class="comments">; mean, covariance matrix and amplitude.</span>
<span class="comments">;</span>
<span class="comments">; Compatible with mpfit</span>
<span class="comments">; :Params:</span>
<span class="comments">;    x : in, required</span>
<span class="comments">;       [n,N] Array of n-dimensional input values</span>
<span class="comments">;    params : in, optional</span>
<span class="comments">;       [1 + n + (n*(n+1))/2] = [amp,mean,cov]</span>
<span class="comments">;</span>
<span class="comments">;	        WHERE	amp	amplitude (scalar)</span>
<span class="comments">;</span>
<span class="comments">;		mean	[n] Mean of each dimension</span>
<span class="comments">;</span>
<span class="comments">;		cov	[(n*(n+1))/2] Unique components of symmetric</span>
<span class="comments">;			covariance matrix, e.g., 00, 01, 02, 11, 12, 22 for 3-d</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    amp : in, optional</span>
<span class="comments">;       amplitude (optional; default=1)</span>
<span class="comments">;    mean : in, optional</span>
<span class="comments">;       [n] Mean of each dimension</span>
<span class="comments">;    cov : in, optional</span>
<span class="comments">;       [n,n] Covariance matrix</span>
<span class="comments">; :Returns:</span>
<span class="comments">;    [N] probability density of specified normal distribution</span>
<span class="comments">;    at _x_</span>
<span class="comments">; :Examples:</span>
<span class="comments">;    Identical result:</span>
<span class="comments">;</span>
<span class="comments">;    y=ajs_gaussnd([1,2,3],mean=[0,0,0],cov=[[1,0,0],[0,1,0],[0,0,1]])</span>
<span class="comments">;</span>
<span class="comments">;    y=ajs_gaussnd([1,2,3],amp=1,mean=[0,0,0],cov=[[1,0,0],[0,1,0],[0,0,1]])</span>
<span class="comments">;</span>
<span class="comments">;    y=ajs_gaussnd([1,2,3],[1,0,0,0,1,0,0,1,0,1])</span>
<span class="comments">; :History:</span>
<span class="comments">;    7 Sep 2007: Created, Anthony Smith</span>
<span class="comments">;-</span>
FUNCTION ajs_gaussnd,x,params,amp=amp,mean=mean,cov=cov
  compile_opt idl2

  IF n_params() EQ 2 THEN BEGIN
      n=(-3 + sqrt(9+8*(n_elements(params)-1)))/2
      amp = params[0]
      mean = params[1:n]
      cov=dblarr(n,n)
      k=0
      FOR i=0,n-1 DO BEGIN
          FOR j=i,n-1 DO BEGIN
              cov[i,j]=params[n+1+k]
              cov[j,i]=params[n+1+k]
              k=k+1
          ENDFOR
      ENDFOR
  ENDIF ELSE BEGIN
      n = n_elements(mean)
      IF n_elements(amp) EQ 0 THEN amp=1
  ENDELSE

  <span class="comments">;; For each element in the input array, x, calculate y=f(x)</span>
  y=dblarr(n_elements(x)/n) 
  a = amp * 1./((2*!PI)^(n/2.)*sqrt(abs(determ(cov,/double))))
  invertcov = invert(cov,/double)
  FOR i = 0,n_elements(x)/n-1 DO BEGIN
      y[i] = a * exp( -1./2 * (x[*,i]-mean) ## invertcov ## (1#(x[*,i]-mean)) )
  ENDFOR 

  RETURN,y
END
</code>
    </div>
  </body>
</html>