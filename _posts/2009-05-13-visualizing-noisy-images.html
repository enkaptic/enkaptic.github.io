---
layout: post
title: Visualizing noisy images
categories:
- Computing
tags:
- photometry
- Python
- visualization
status: publish
type: post
published: true
meta:
  _edit_last: '2'
---
<p>You have an image. Each pixel has a value with some uncertainty. How do you visualize the uncertainty in each pixel? Like this:</p>
<p><a href="{{ site.url }}/assets//flicker_image.gif"><img class="alignnone size-full wp-image-197" title="flicker_image" src="{{ site.url }}/assets//flicker_image.gif" alt="flicker_image" width="100%" /></a></p>
<p>Here's the Python code</p>
<pre lang="python">
import numpy as np
from matplotlib import pyplot as plt

class FlickerImage(object):
    def __init__(self, im, err):
        self.im = im.copy()
        self.err = err.copy()
        finite = np.isfinite(self.im + self.err)
        self.vmin = (self.im - 2 * self.err)[finite].min()
        self.vmax = (self.im + 2 * self.err)[finite].max()
        self.im[np.invert(finite)] = self.vmax
        self.err[np.invert(finite)] = 0
    def flicker(self):
        fg = plt.imshow(np.zeros(self.im.shape),
                        interpolation='nearest',
                        vmin=self.vmin,
                        vmax=self.vmax)
        while True:
            ran = np.random.normal(size=im.shape)
            fg.set_data(im + err * ran)
            plt.draw()
</pre>
<p>And here's an example script:</p>
<pre lang="python">import pyfits
f = pyfits.open('file.fits')
im = f["IMAGE"].data
err = f["ERROR"].data
flicker_image = FlickerImage(im, err)
flicker_image.flicker()</pre>
